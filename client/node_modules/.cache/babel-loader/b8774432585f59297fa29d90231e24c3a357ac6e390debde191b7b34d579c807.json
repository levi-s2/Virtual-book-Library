{"ast":null,"code":"// src/axiosConfig.js\nimport axios from'axios';import{refreshToken}from'./utils/auth';const instance=axios.create({baseURL:process.env.REACT_APP_API_URL||'http://localhost:5000'});instance.interceptors.request.use(async config=>{const token=localStorage.getItem('token');if(token){config.headers['Authorization']=\"Bearer \".concat(token);}return config;},error=>{Promise.reject(error);});instance.interceptors.response.use(response=>{return response;},async error=>{const originalRequest=error.config;if(error.response.status===401&&!originalRequest._retry){originalRequest._retry=true;const newToken=await refreshToken();if(newToken){axios.defaults.headers.common['Authorization']=\"Bearer \".concat(newToken);return axios(originalRequest);}}return Promise.reject(error);});export default instance;","map":{"version":3,"names":["axios","refreshToken","instance","create","baseURL","process","env","REACT_APP_API_URL","interceptors","request","use","config","token","localStorage","getItem","headers","concat","error","Promise","reject","response","originalRequest","status","_retry","newToken","defaults","common"],"sources":["/home/levi/Development/code/phase-4/book-store/client/src/components/axiosConfig.js"],"sourcesContent":["// src/axiosConfig.js\n\nimport axios from 'axios';\nimport { refreshToken } from './utils/auth';\n\nconst instance = axios.create({\n  baseURL: process.env.REACT_APP_API_URL || 'http://localhost:5000'\n});\n\ninstance.interceptors.request.use(\n  async (config) => {\n    const token = localStorage.getItem('token');\n    if (token) {\n      config.headers['Authorization'] = `Bearer ${token}`;\n    }\n    return config;\n  },\n  (error) => {\n    Promise.reject(error)\n  }\n);\n\ninstance.interceptors.response.use(\n  (response) => {\n    return response;\n  },\n  async (error) => {\n    const originalRequest = error.config;\n\n    if (error.response.status === 401 && !originalRequest._retry) {\n      originalRequest._retry = true;\n      const newToken = await refreshToken();\n      if (newToken) {\n        axios.defaults.headers.common['Authorization'] = `Bearer ${newToken}`;\n        return axios(originalRequest);\n      }\n    }\n\n    return Promise.reject(error);\n  }\n);\n\nexport default instance;\n"],"mappings":"AAAA;AAEA,MAAO,CAAAA,KAAK,KAAM,OAAO,CACzB,OAASC,YAAY,KAAQ,cAAc,CAE3C,KAAM,CAAAC,QAAQ,CAAGF,KAAK,CAACG,MAAM,CAAC,CAC5BC,OAAO,CAAEC,OAAO,CAACC,GAAG,CAACC,iBAAiB,EAAI,uBAC5C,CAAC,CAAC,CAEFL,QAAQ,CAACM,YAAY,CAACC,OAAO,CAACC,GAAG,CAC/B,KAAO,CAAAC,MAAM,EAAK,CAChB,KAAM,CAAAC,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAC3C,GAAIF,KAAK,CAAE,CACTD,MAAM,CAACI,OAAO,CAAC,eAAe,CAAC,WAAAC,MAAA,CAAaJ,KAAK,CAAE,CACrD,CACA,MAAO,CAAAD,MAAM,CACf,CAAC,CACAM,KAAK,EAAK,CACTC,OAAO,CAACC,MAAM,CAACF,KAAK,CAAC,CACvB,CACF,CAAC,CAEDf,QAAQ,CAACM,YAAY,CAACY,QAAQ,CAACV,GAAG,CAC/BU,QAAQ,EAAK,CACZ,MAAO,CAAAA,QAAQ,CACjB,CAAC,CACD,KAAO,CAAAH,KAAK,EAAK,CACf,KAAM,CAAAI,eAAe,CAAGJ,KAAK,CAACN,MAAM,CAEpC,GAAIM,KAAK,CAACG,QAAQ,CAACE,MAAM,GAAK,GAAG,EAAI,CAACD,eAAe,CAACE,MAAM,CAAE,CAC5DF,eAAe,CAACE,MAAM,CAAG,IAAI,CAC7B,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAAvB,YAAY,CAAC,CAAC,CACrC,GAAIuB,QAAQ,CAAE,CACZxB,KAAK,CAACyB,QAAQ,CAACV,OAAO,CAACW,MAAM,CAAC,eAAe,CAAC,WAAAV,MAAA,CAAaQ,QAAQ,CAAE,CACrE,MAAO,CAAAxB,KAAK,CAACqB,eAAe,CAAC,CAC/B,CACF,CAEA,MAAO,CAAAH,OAAO,CAACC,MAAM,CAACF,KAAK,CAAC,CAC9B,CACF,CAAC,CAED,cAAe,CAAAf,QAAQ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}