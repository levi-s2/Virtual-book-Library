{"ast":null,"code":"import React,{useEffect,useState}from'react';import axios from\"./axiosConfig\";import ClipLoader from'react-spinners/ClipLoader';import{Link}from'react-router-dom';import'./css/UserReviews.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const UserReviews=_ref=>{let{user}=_ref;const[reviews,setReviews]=useState([]);const[loading,setLoading]=useState(true);const[editingReviewId,setEditingReviewId]=useState(null);const[editReviewBody,setEditReviewBody]=useState('');useEffect(()=>{const fetchReviews=async()=>{const token=localStorage.getItem('token');try{const response=await axios.get('/user/reviews',{headers:{Authorization:\"Bearer \".concat(token)}});setReviews(response.data);setLoading(false);}catch(error){console.error('Error fetching user reviews:',error);setLoading(false);}};fetchReviews();},[user]);const handleDeleteReview=async reviewId=>{const token=localStorage.getItem('token');try{await axios.delete(\"/user/reviews/\".concat(reviewId),{headers:{Authorization:\"Bearer \".concat(token)}});setReviews(reviews.filter(review=>review.id!==reviewId));}catch(error){console.error('Error deleting review:',error);}};const handleEditReview=reviewId=>{setEditingReviewId(reviewId);const reviewToEdit=reviews.find(review=>review.id===reviewId);setEditReviewBody(reviewToEdit.body);};const handleUpdateReview=async reviewId=>{if(editReviewBody.trim()===''){alert('Review cannot be empty');return;}const token=localStorage.getItem('token');try{await axios.patch(\"/user/reviews/\".concat(reviewId),{body:editReviewBody},{headers:{Authorization:\"Bearer \".concat(token)}});setReviews(reviews.map(review=>review.id===reviewId?{...review,body:editReviewBody}:review));setEditingReviewId(null);setEditReviewBody('');}catch(error){console.error('Error updating review:',error);}};return/*#__PURE__*/_jsx(\"div\",{className:\"user-reviews-container\",children:loading?/*#__PURE__*/_jsx(ClipLoader,{size:50,color:\"#007bff\"}):reviews.length===0?/*#__PURE__*/_jsx(\"div\",{className:\"empty-reviews-message\",children:/*#__PURE__*/_jsxs(\"p\",{children:[\"Your review list is currently empty. To add some reviews, go to \",/*#__PURE__*/_jsx(Link,{to:\"/\",children:\"home page\"}),\" and choose a book.\"]})}):reviews.map(review=>/*#__PURE__*/_jsxs(\"div\",{className:\"review-card\",children:[/*#__PURE__*/_jsx(\"h3\",{children:review.book.title}),editingReviewId===review.id?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"textarea\",{value:editReviewBody,onChange:e=>setEditReviewBody(e.target.value)}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleUpdateReview(review.id),children:\"Update Review\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setEditingReviewId(null),children:\"Cancel\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"p\",{children:review.body}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleEditReview(review.id),children:\"Edit\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDeleteReview(review.id),children:\"Delete\"})]})]},review.id))});};export default UserReviews;","map":{"version":3,"names":["React","useEffect","useState","axios","ClipLoader","Link","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","UserReviews","_ref","user","reviews","setReviews","loading","setLoading","editingReviewId","setEditingReviewId","editReviewBody","setEditReviewBody","fetchReviews","token","localStorage","getItem","response","get","headers","Authorization","concat","data","error","console","handleDeleteReview","reviewId","delete","filter","review","id","handleEditReview","reviewToEdit","find","body","handleUpdateReview","trim","alert","patch","map","className","children","size","color","length","to","book","title","value","onChange","e","target","onClick"],"sources":["/home/levi/Development/code/phase-4/book-store/client/src/components/UserReviews.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport axios from \"./axiosConfig\";\nimport ClipLoader from 'react-spinners/ClipLoader';\nimport { Link } from 'react-router-dom';\nimport './css/UserReviews.css';\n\nconst UserReviews = ({ user }) => {\n  const [reviews, setReviews] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [editingReviewId, setEditingReviewId] = useState(null);\n  const [editReviewBody, setEditReviewBody] = useState('');\n\n  useEffect(() => {\n    const fetchReviews = async () => {\n      const token = localStorage.getItem('token');\n      try {\n        const response = await axios.get('/user/reviews', {\n          headers: {\n            Authorization: `Bearer ${token}`,\n          },\n        });\n        setReviews(response.data);\n        setLoading(false);\n      } catch (error) {\n        console.error('Error fetching user reviews:', error);\n        setLoading(false);\n      }\n    };\n\n    fetchReviews();\n  }, [user]);\n\n  const handleDeleteReview = async (reviewId) => {\n    const token = localStorage.getItem('token');\n    try {\n      await axios.delete(`/user/reviews/${reviewId}`, {\n        headers: {\n          Authorization: `Bearer ${token}`,\n        },\n      });\n      setReviews(reviews.filter(review => review.id !== reviewId));\n    } catch (error) {\n      console.error('Error deleting review:', error);\n    }\n  };\n\n  const handleEditReview = (reviewId) => {\n    setEditingReviewId(reviewId);\n    const reviewToEdit = reviews.find(review => review.id === reviewId);\n    setEditReviewBody(reviewToEdit.body);\n  };\n\n  const handleUpdateReview = async (reviewId) => {\n    if (editReviewBody.trim() === '') {\n      alert('Review cannot be empty');\n      return;\n    }\n\n    const token = localStorage.getItem('token');\n    try {\n      await axios.patch(`/user/reviews/${reviewId}`, {\n        body: editReviewBody,\n      }, {\n        headers: {\n          Authorization: `Bearer ${token}`,\n        },\n      });\n      setReviews(reviews.map(review => (review.id === reviewId ? { ...review, body: editReviewBody } : review)));\n      setEditingReviewId(null);\n      setEditReviewBody('');\n    } catch (error) {\n      console.error('Error updating review:', error);\n    }\n  };\n\n  return (\n    <div className=\"user-reviews-container\">\n      {loading ? (\n        <ClipLoader size={50} color={\"#007bff\"} />\n      ) : (\n        reviews.length === 0 ? (\n          <div className=\"empty-reviews-message\">\n            <p>Your review list is currently empty. To add some reviews, go to <Link to=\"/\">home page</Link> and choose a book.</p>\n          </div>\n        ) : (\n          reviews.map(review => (\n            <div key={review.id} className=\"review-card\">\n              <h3>{review.book.title}</h3>\n              {editingReviewId === review.id ? (\n                <>\n                  <textarea\n                    value={editReviewBody}\n                    onChange={(e) => setEditReviewBody(e.target.value)}\n                  />\n                  <button onClick={() => handleUpdateReview(review.id)}>Update Review</button>\n                  <button onClick={() => setEditingReviewId(null)}>Cancel</button>\n                </>\n              ) : (\n                <>\n                  <p>{review.body}</p>\n                  <button onClick={() => handleEditReview(review.id)}>Edit</button>\n                  <button onClick={() => handleDeleteReview(review.id)}>Delete</button>\n                </>\n              )}\n            </div>\n          ))\n        )\n      )}\n    </div>\n  );\n};\n\nexport default UserReviews;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}